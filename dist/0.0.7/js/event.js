(function(){this.Event=function(){function e(){$(document).keydown(function(e){return(e.metaKey||e.ctrlKey)&&"s"===String.fromCharCode(e.keyCode).toLowerCase()?(action.save_file(),e.preventDefault(),!1):(27===e.keyCode&&action.exit_full_window(),!0)}),$("#tabs").on("tabsactivate",function(e,t){var o,n;return n=t.newPanel.data("uid"),o=editors[n],o&&(o=o.editor,o.resize(),o.setShowInvisibles(!0),o.setShowInvisibles(!1)),application.refresh_sidebar(t.newPanel.data("path"))}),window.onbeforeunload=function(){var e,t,o,n;chrome.storage.local.set({path:document.title}),n=[];for(o in editors)if(e=editors[o],n.push(e.path),t=$("#link-"+e.uid).text(),0===t.indexOf("* "))return'"'+t.substr(2)+'" '+chrome.i18n.getMessage("save_before_leaving");return chrome.storage.local.set({paths:n})},$("body").on("click",".file_link",function(){return action.open_file($(this).data("path"))}),$("body").on("click",".folder_link",function(){return action.open_folder($(this).data("path"))}),$("body").on("click","span.ui-icon-close",function(){var e;return e=$(this).closest("li").attr("aria-controls").substr(4),editors[e].dispose()}),$("body").on("click",".options_btn",function(){return chrome.tabs.create({url:chrome.extension.getURL("html/options.html")})}),$("body").on("click",".full_window_btn",function(){return action.full_window()}),$("body").on("click",".save_btn",function(){return action.save_file()}),$("body").on("click",".save_all_btn",function(){var e,t,o;o=[];for(t in editors)e=editors[t],o.push(e.save_file());return o}),$("body").on("click",".new_file_btn",function(){return setTimeout(function(){return action.create_file()},50)}),$("body").on("click",".new_folder_btn",function(){return setTimeout(function(){return action.create_folder()},50)}),$("body").on("click",".find_btn",function(){var e;return e=util.current_editor(),e?ace.require("ace/ext/searchbox").Search(e.editor):void 0}),$("body").on("click",".replace_btn",function(){var e;return e=util.current_editor(),e?ace.require("ace/ext/searchbox").Search(e.editor,!0):void 0}),$("body").on("click",".toggle_invisibles_btn",function(){var e;return e=util.current_editor(),e?e.editor.setShowInvisibles(!e.editor.getShowInvisibles()):void 0}),$("body").on("click",".indent_btn",function(){var e;return e=util.current_editor(),e?e.editor.indent():void 0}),$("body").on("click",".outdent_btn",function(){var e;return e=util.current_editor(),e?e.editor.blockOutdent():void 0}),$("body").on("click",".lower_case_btn",function(){var e;return e=util.current_editor(),e?e.editor.toLowerCase():void 0}),$("body").on("click",".upper_case_btn",function(){var e;return e=util.current_editor(),e?e.editor.toUpperCase():void 0}),$("body").on("click",".remove_lines_btn",function(){var e;return e=util.current_editor(),e?e.editor.removeLines():void 0}),$("body").on("click",".toggle_comment_btn",function(){var e;return e=util.current_editor(),e?e.editor.toggleCommentLines():void 0}),$("body").on("click",".mode_link",function(){var e;return e=util.current_editor(),e?e.editor.getSession().setMode("ace/mode/"+$(this).data("mode")):void 0}),$("body").on("click",".toggle_word_wrap_btn",function(){var e,t;return e=util.current_editor(),e?(t=e.editor.getSession().getUseWrapMode(),e.editor.getSession().setUseWrapMode(!t)):void 0}),$("body").on("click",".check_for_updates_btn",function(){return action.check_for_updates()}),$("body").on("click",".about_btn",function(){return util.notice("Slim Text "+chrome.app.getDetails().version,"Copyright Â© 2012 - 2013 slimtext.org",5e3)}),$("body").on("click",".close_tab_btn",function(){var e;return e=util.current_editor(),e?e.dispose():void 0}),$("body").on("click",".close_other_tabs_btn",function(){var e,t,o,n;if(e=util.current_editor()){n=[];for(o in editors)t=editors[o],e.uid!==t.uid?n.push(t.dispose()):n.push(void 0);return n}}),$("body").on("click",".close_all_tabs_btn",function(){var e,t,o;o=[];for(t in editors)e=editors[t],o.push(e.dispose());return o}),$("body").on("click",".pop_out_btn",function(){return chrome.windows.create({url:chrome.extension.getURL("html/main.html"),type:"popup",width:800,height:600})}),$("body").on("change","#drives_select",function(){return action.open_folder($(this).val())})}return e}(),this.Action=function(){function e(){}return e.prototype.open_file=function(e){var t,o,n,i;if(!file_manager.exists(e))return util.notice(chrome.i18n.getMessage("does_not_exist"),e),void 0;for(n in editors)if(t=editors[n],e===t.path)return i=t.uid,o=$("#tabs ul li").index($("#li-"+i)),$("#tabs").tabs("option","active",o),void 0;return application.open_file(e)},e.prototype.save_file=function(){var e;return e=util.current_editor(),e?e.save_file():void 0},e.prototype.open_folder=function(e){return file_manager.exists(e)?(file_manager.can_list(e)||(util.notice(chrome.i18n.getMessage("permission_denied"),e),e=file_manager.home_folder()||file_manager.temp_folder()),application.show_breadcrumb(e),application.show_sidebar(e)):(util.notice(chrome.i18n.getMessage("does_not_exist"),e),void 0)},e.prototype.exit_full_window=function(){return window.layout.state.north.isClosed?window.layout.open("north"):void 0},e.prototype.full_window=function(){return window.layout.state.north.isVisible?window.layout.close("north"):void 0},e.prototype.create_file=function(){var e;return(e=util.prompt_path_name("file"))?(file_manager.create_file(e),application.refresh_sidebar(),action.open_file(e)):void 0},e.prototype.create_folder=function(){var e;return(e=util.prompt_path_name("folder"))?(file_manager.create_folder(e),application.refresh_sidebar()):void 0},e.prototype.check_for_updates=function(){return $.get("https://raw.github.com/tylerlong/slimtext.org/gh-pages/__version__",function(e){var t,o;return o=e.trim(),t=chrome.app.getDetails().version,o>t?util.notice(""+chrome.i18n.getMessage("new_version")+": "+o,chrome.i18n.getMessage("fetch_and_install"),8e3):util.notice(chrome.i18n.getMessage("no_update"),""+chrome.i18n.getMessage("newest_version")+": "+t,5e3)}).fail(function(){return util.notice(chrome.i18n.getMessage("network_error"),chrome.i18n.getMessage("check_manually"),5e3)})},e}()}).call(this);